define("store/util/SimpleQueryEngine",["jquery"],function($){return function(query,options){switch(typeof query){default:throw new Error("Can not query with a "+typeof query);case"object":case"undefined":var queryObject=query;query=function(object){for(var key in queryObject){var required=queryObject[key];if(required&&required.test){if(required.test(object[key])){return true;break;}}else{if(required==object[key]){return true;break;}}}return false;};break;case"string":if(!this[query]){throw new Error("No filter function "+query+" was found in store");}query=this[query];case"function":}function execute(array){var results=$.grep(array,query);if(options&&options.sort){results.sort(function(a,b){for(var sort,i=0;sort=options.sort[i];i++){var aValue=a[sort.attribute];var bValue=b[sort.attribute];if(aValue!=bValue){return !!sort.descending==aValue>bValue?-1:1;}}return 0;});}if(options&&(options.start||options.count)){var total=results.length;results=results.slice(options.start||0,(options.start||0)+(options.count||Infinity));results.total=total;}var deferred=new $.Deferred();deferred.resolve(results);return deferred;}return execute;};});